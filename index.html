
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>paxexpress docs</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-of-paxexpress" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="paxexpress docs" class="md-header__button md-logo" aria-label="paxexpress docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            paxexpress docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Readme
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="paxexpress docs" class="md-nav__button md-logo" aria-label="paxexpress docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    paxexpress docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Readme
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        Readme
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup-guide" class="md-nav__link">
    Setup guide
  </a>
  
    <nav class="md-nav" aria-label="Setup guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tooling" class="md-nav__link">
    Tooling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registration-and-login" class="md-nav__link">
    Registration and login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repositories-and-packages" class="md-nav__link">
    Repositories and packages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashing-and-ota" class="md-nav__link">
    Flashing and OTA
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup-guide" class="md-nav__link">
    Setup guide
  </a>
  
    <nav class="md-nav" aria-label="Setup guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tooling" class="md-nav__link">
    Tooling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registration-and-login" class="md-nav__link">
    Registration and login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repositories-and-packages" class="md-nav__link">
    Repositories and packages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashing-and-ota" class="md-nav__link">
    Flashing and OTA
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="using-of-paxexpress">Using of PAX.express</h1>
<p>The PAX.express service is used for the delivery of firmware to esp32 paxcounter devices. This is done by using the OTA feature of the <a href="https://github.com/cyberman54/ESP32-Paxcounter">ESP32-paxcounter project</a>. Our fork can be found <a href="https://github.com/paxexpress/ESP32-Paxcounter">here</a>, which is already setup to use PAX.express to deliver firmware updates. The PAX.express cli can be found <a href="https://github.com/paxexpress/paxexpress-cli">here</a>.</p>
<h2 id="setup-guide">Setup guide</h2>
<h3 id="tooling">Tooling</h3>
<p>Please clone the <a href="https://github.com/paxexpress/paxexpress-cli">paxexpress-cli</a> to your filesystem. 
For installation informations read the <a href="https://github.com/paxexpress/paxexpress-cli/blob/master/README.md">README.md</a>.</p>
<h3 id="registration-and-login">Registration and login</h3>
<p>After installation you can use either <code>./paxexpress</code> or <code>paxexpress.exe</code> depending of your platform. Substitute the command in the following guide accordingly to your enviroment.</p>
<p>Using <code>auth</code> module of the paxexpress-cli you can use the register command to register to the PAX.express service.</p>
<pre><code>paxexpress auth register
</code></pre>
<p>You will need the provided beta key at this step.</p>
<p>After registration you can use the login command to get a 30min token for auth against your account which is stored in your operating system's password store. </p>
<pre><code>paxexpress auth login
</code></pre>
<p>When you want to remove your auth informations use. </p>
<pre><code>paxexpress auth logout
</code></pre>
<h3 id="repositories-and-packages">Repositories and packages</h3>
<p>PAX.express uses the structure of repositories which contain packages which again have different versions.</p>
<p>At first you should create a repository to store your packages.</p>
<pre><code>paxexpress repository create
</code></pre>
<p>You will be asked for a repository and some description.</p>
<p>After setting the name you can use this name to reference the repository in further commands e.g.</p>
<pre><code>paxexpress package create -r YourChoosenRepoName
</code></pre>
<p>This command creates a package relative to your repository.</p>
<p>After this steps your read to prepare the upload of your first firmware.</p>
<h2 id="flashing-and-ota">Flashing and OTA</h2>
<p>You will need the platformio tools to proced with this guide. You can get those e.g. by installing them with your package manager of choise. How to work with platformio is out of scope of this guide.</p>
<p>Lets shift our focus to the firmware repo <a href="https://github.com/paxexpress/ESP32-Paxcounter">here</a>. First you need to make copies of <code>platformio_orig.ini</code> naming it <code>platformio.ini</code>. In this file you can adjust the Board section and comment in your used <code>board</code>.</p>
<p>You also have to create a package on paxexpress by using the cli for the specific boardname. E.g commenting in <code>olimexpoeiso.h</code> you would have to have the package <code>olimexpoeiso</code> on your repository in paxexpress to store the versions for this specific board class.</p>
<p>Use this cli command and set the name of the package to the boardname you choose:</p>
<pre><code>paxexpress package create -r YourChoosenRepoName
</code></pre>
<p>Also have a look at <code>platformio</code> section. Here you can choose the <code>default_envs</code> to be <code>ota</code> for uploading to PAX.express or <code>usb</code> for flashing your device localy. In the first step we us local flashing, there for we use the <code>usb</code> <code>default_envs</code>.</p>
<p>Now please make a copy of <code>src/paxcounter_orig.conf</code> and rename it to <code>src/paxcounter.conf</code>.</p>
<p>In this file you configure your paxcounter. Please adjust the values accordingly to your wished configuration. Be aware that you will need to receive rcommands at the later part of this guide. E.g. this can be done by using mqtt and a ethernet port.</p>
<p>Now please make a copy of <code>src/loraconf_sample.h</code> and rename it to <code>src/loraconf.h</code>. Also  make a copy of <code>src/ota_sample.conf</code> and rename it to <code>src/ota.conf</code>. In the later file change <code>BINTRAY_USER</code> to your user (not your email you using for login!) on PAX.express, <code>BINTRAY_REPO</code> to your created Repositorys' name and <code>BINTRAY_API_TOKEN</code> to your password.</p>
<p>Also <code>OTA_WIFI_SSID</code> and <code>OTA_WIFI_PASS</code> needs to be set to a network the OTA will downloaded over. BE AWARE THIS WIFI CREDENTAILS WILL BE UPLOADED TO PAXEXPRESS INSIDE THE FIRMWARE AND ARE AVALIBLE PUBLICLY ON THE SERVICE AT THIS POINT.</p>
<p>Now you are ready to flash the firmware on your board by using platformio tools.</p>
<pre><code>pio run -t upload 
</code></pre>
<p>When you want to upload a version of the firmware for OTA set the
<code>default_envs</code> to be <code>ota</code> in <code>platformio.ini</code>. Now you can use the same commmand to upload it to PAX.express, but you should increment the <code>release_version</code> in <code>platformio.ini</code> under <code>common</code>.</p>
<pre><code>pio run -t upload 
</code></pre>
<p>Now the rcommand to trigger OTA can be used: <code>[0x09 0x09]</code> via LoRa or <code>CQk=</code> via mqtt</p>
<p>When downgrading versions be aware to earse the flash beforehand
while being on the env <code>usb</code> with</p>
<pre><code>pio run -t erase 
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.76f349be.min.js"></script>
      
    
  </body>
</html>